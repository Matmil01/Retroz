var B=Object.defineProperty;var C=(i,t,r)=>t in i?B(i,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[t]=r;var $=(i,t,r)=>C(i,typeof t!="symbol"?t+"":t,r);class D extends Error{constructor(r,a,h,f,m){super(`${r}:${h}:${f}: ${a}`);$(this,"reason");$(this,"filename");$(this,"line");$(this,"column");$(this,"source");this.reason=a,this.filename=r,this.line=h,this.column=f,this.source=m}}class G{constructor(t,r,a){$(this,"start");$(this,"end");$(this,"source");this.start=t,this.end=r,this.source=a}}var o;(function(i){i.stylesheet="stylesheet",i.rule="rule",i.declaration="declaration",i.comment="comment",i.container="container",i.charset="charset",i.document="document",i.customMedia="custom-media",i.fontFace="font-face",i.host="host",i.import="import",i.keyframes="keyframes",i.keyframe="keyframe",i.layer="layer",i.media="media",i.namespace="namespace",i.page="page",i.startingStyle="starting-style",i.supports="supports"})(o||(o={}));const T=(i,t,r)=>{let a=r,h=1e4;do{const f=t.map(p=>i.indexOf(p,a));f.push(i.indexOf("\\",a));const m=f.filter(p=>p!==-1);if(m.length===0)return-1;const d=Math.min(...m);if(i[d]!=="\\")return d;a=d+2,h--}while(h>0);throw new Error("Too many escaping")},b=(i,t,r)=>{let a=r,h=1e4;do{const f=t.map(p=>i.indexOf(p,a));f.push(i.indexOf("(",a)),f.push(i.indexOf('"',a)),f.push(i.indexOf("'",a)),f.push(i.indexOf("\\",a));const m=f.filter(p=>p!==-1);if(m.length===0)return-1;const d=Math.min(...m);switch(i[d]){case"\\":a=d+2;break;case"(":{const p=b(i,[")"],d+1);if(p===-1)return-1;a=p+1}break;case'"':{const p=T(i,['"'],d+1);if(p===-1)return-1;a=p+1}break;case"'":{const p=T(i,["'"],d+1);if(p===-1)return-1;a=p+1}break;default:return d}h--}while(h>0);throw new Error("Too many escaping")},j=/\/\*[^]*?(?:\*\/|$)/g;function x(i){return i?i.trim():""}function O(i,t){const r=i&&typeof i.type=="string",a=r?i:t;for(const h in i){const f=i[h];Array.isArray(f)?f.forEach(m=>{O(m,a)}):f&&typeof f=="object"&&O(f,a)}return r&&Object.defineProperty(i,"parent",{configurable:!0,writable:!0,enumerable:!1,value:t||null}),i}class H{constructor(t){$(this,"level",0);$(this,"indentation","  ");$(this,"compress",!1);typeof(t==null?void 0:t.indent)=="string"&&(this.indentation=t==null?void 0:t.indent),t!=null&&t.compress&&(this.compress=!0)}emit(t,r){return t}indent(t){return this.level=this.level||1,t?(this.level+=t,""):Array(this.level).join(this.indentation)}visit(t){switch(t.type){case o.stylesheet:return this.stylesheet(t);case o.rule:return this.rule(t);case o.declaration:return this.declaration(t);case o.comment:return this.comment(t);case o.container:return this.container(t);case o.charset:return this.charset(t);case o.document:return this.document(t);case o.customMedia:return this.customMedia(t);case o.fontFace:return this.fontFace(t);case o.host:return this.host(t);case o.import:return this.import(t);case o.keyframes:return this.keyframes(t);case o.keyframe:return this.keyframe(t);case o.layer:return this.layer(t);case o.media:return this.media(t);case o.namespace:return this.namespace(t);case o.page:return this.page(t);case o.startingStyle:return this.startingStyle(t);case o.supports:return this.supports(t)}}mapVisit(t,r){let a="";r=r||"";for(let h=0,f=t.length;h<f;h++)a+=this.visit(t[h]),r&&h<f-1&&(a+=this.emit(r));return a}compile(t){return this.compress?t.stylesheet.rules.map(this.visit,this).join(""):this.stylesheet(t)}stylesheet(t){return this.mapVisit(t.stylesheet.rules,`

`)}comment(t){return this.compress?this.emit("",t.position):this.emit(`${this.indent()}/*${t.comment}*/`,t.position)}container(t){return this.compress?this.emit(`@container ${t.container}`,t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit(`${this.indent()}@container ${t.container}`,t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`
${this.indent(-1)}${this.indent()}}`)}layer(t){return this.compress?this.emit(`@layer ${t.layer}`,t.position)+(t.rules?this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):";"):this.emit(`${this.indent()}@layer ${t.layer}`,t.position)+(t.rules?this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`
${this.indent(-1)}${this.indent()}}`):";")}import(t){return this.emit(`@import ${t.import};`,t.position)}media(t){return this.compress?this.emit(`@media ${t.media}`,t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit(`${this.indent()}@media ${t.media}`,t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`
${this.indent(-1)}${this.indent()}}`)}document(t){const r=`@${t.vendor||""}document ${t.document}`;return this.compress?this.emit(r,t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit(r,t.position)+this.emit(`  {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`${this.indent(-1)}
}`)}charset(t){return this.emit(`@charset ${t.charset};`,t.position)}namespace(t){return this.emit(`@namespace ${t.namespace};`,t.position)}startingStyle(t){return this.compress?this.emit("@starting-style",t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit(`${this.indent()}@starting-style`,t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`
${this.indent(-1)}${this.indent()}}`)}supports(t){return this.compress?this.emit(`@supports ${t.supports}`,t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit(`${this.indent()}@supports ${t.supports}`,t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`
${this.indent(-1)}${this.indent()}}`)}keyframes(t){return this.compress?this.emit(`@${t.vendor||""}keyframes ${t.name}`,t.position)+this.emit("{")+this.mapVisit(t.keyframes)+this.emit("}"):this.emit(`@${t.vendor||""}keyframes ${t.name}`,t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.keyframes,`
`)+this.emit(`${this.indent(-1)}}`)}keyframe(t){const r=t.declarations;return this.compress?this.emit(t.values.join(","),t.position)+this.emit("{")+this.mapVisit(r)+this.emit("}"):this.emit(this.indent())+this.emit(t.values.join(", "),t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(r,`
`)+this.emit(`${this.indent(-1)}
${this.indent()}}
`)}page(t){if(this.compress){const a=t.selectors.length?t.selectors.join(", "):"";return this.emit(`@page ${a}`,t.position)+this.emit("{")+this.mapVisit(t.declarations)+this.emit("}")}const r=t.selectors.length?`${t.selectors.join(", ")} `:"";return this.emit(`@page ${r}`,t.position)+this.emit(`{
`)+this.emit(this.indent(1))+this.mapVisit(t.declarations,`
`)+this.emit(this.indent(-1))+this.emit(`
}`)}fontFace(t){return this.compress?this.emit("@font-face",t.position)+this.emit("{")+this.mapVisit(t.declarations)+this.emit("}"):this.emit("@font-face ",t.position)+this.emit(`{
`)+this.emit(this.indent(1))+this.mapVisit(t.declarations,`
`)+this.emit(this.indent(-1))+this.emit(`
}`)}host(t){return this.compress?this.emit("@host",t.position)+this.emit("{")+this.mapVisit(t.rules)+this.emit("}"):this.emit("@host",t.position)+this.emit(` {
${this.indent(1)}`)+this.mapVisit(t.rules,`

`)+this.emit(`${this.indent(-1)}
}`)}customMedia(t){return this.emit(`@custom-media ${t.name} ${t.media};`,t.position)}rule(t){const r=t.declarations;if(!r.length)return"";if(this.compress)return this.emit(t.selectors.join(","),t.position)+this.emit("{")+this.mapVisit(r)+this.emit("}");const a=this.indent();return this.emit(t.selectors.map(h=>a+h).join(`,
`),t.position)+this.emit(` {
`)+this.emit(this.indent(1))+this.mapVisit(r,`
`)+this.emit(this.indent(-1))+this.emit(`
${this.indent()}}`)}declaration(t){return this.compress?this.emit(`${t.property}:${t.value}`,t.position)+this.emit(";"):t.property==="grid-template-areas"?this.emit(this.indent())+this.emit(t.property+": "+t.value.split(`
`).join(`
`.padEnd(22)+this.indent()),t.position)+this.emit(";"):this.emit(this.indent())+this.emit(`${t.property}: ${t.value}`,t.position)+this.emit(";")}}const J=(i,t)=>{t=t||{};let r=1,a=1;function h(){const e={line:r,column:a};return s=>(s.position=new G(e,{line:r,column:a},(t==null?void 0:t.source)||""),E(),s)}const f=[];function m(e){const s=new D((t==null?void 0:t.source)||"",e,r,a,i);if(!(t!=null&&t.silent))throw s;f.push(s)}function d(){const e=/^{\s*/.exec(i);return!!e&&(l(e),!0)}function p(){const e=/^}/.exec(i);return!!e&&(l(e),!0)}function k(){let e;const s=[];for(E(),y(s);i.length&&i.charAt(0)!=="}"&&(e=_()||q(),e);)s.push(e),y(s);return s}function l(e){const s=e[0];return(function(n){const c=n.match(/\n/g);c&&(r+=c.length);const u=n.lastIndexOf(`
`);a=~u?n.length-u:a+n.length})(s),i=i.slice(s.length),e}function E(){const e=/^\s*/.exec(i);e&&l(e)}function y(e){e=e||[];let s=M();for(;s;)e.push(s),s=M();return e}function M(){const e=h();if(i.charAt(0)!=="/"||i.charAt(1)!=="*")return;const s=/^\/\*[^]*?\*\//.exec(i);return s?(l(s),e({type:o.comment,comment:s[0].slice(2,-2)})):m("End of comment missing")}function A(){const e=/^([^{]+)/.exec(i);if(e)return l(e),((s,n)=>{const c=[];let u=0;for(;u<s.length;){const g=b(s,n,u);if(g===-1)return c.push(s.substring(u)),c;c.push(s.substring(u,g)),u=g+1}return c})(x(e[0]).replace(j,""),[","]).map(s=>x(s))}function V(){const e=h(),s=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/.exec(i);if(!s)return;l(s);const n=x(s[0]),c=/^:\s*/.exec(i);if(!c)return m("property missing ':'");l(c);let u="";const g=b(i,[";","}"]);g!==-1&&(u=i.substring(0,g),l([u]),u=x(u).replace(j,""));const v=e({type:o.declaration,property:n.replace(j,""),value:u}),z=/^[;\s]*/.exec(i);return z&&l(z),v}function S(){const e=[];if(!d())return m("missing '{'");y(e);let s=V();for(;s;)e.push(s),y(e),s=V();return p()?e:m("missing '}'")}function F(){const e=[],s=h();let n=/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/.exec(i);for(;n;){const c=l(n);e.push(c[1]);const u=/^,\s*/.exec(i);u&&l(u),n=/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/.exec(i)}if(e.length)return s({type:o.keyframe,values:e,declarations:S()||[]})}const I=w("import"),P=w("charset"),R=w("namespace");function w(e){const s=new RegExp("^@"+e+`\\s*((?::?[^;'"]|"(?:\\\\"|[^"])*?"|'(?:\\\\'|[^'])*?')+)(?:;|$)`);return()=>{const n=h(),c=s.exec(i);if(!c)return;const u=l(c),g={type:e};return g[e]=u[1].trim(),n(g)}}function _(){if(i[0]==="@")return(function(){const e=h(),s=/^@([-\w]+)?keyframes\s*/.exec(i);if(!s)return;const n=l(s)[1],c=/^([-\w]+)\s*/.exec(i);if(!c)return m("@keyframes missing name");const u=l(c)[1];if(!d())return m("@keyframes missing '{'");let g=y(),v=F();for(;v;)g.push(v),g=g.concat(y()),v=F();return p()?e({type:o.keyframes,name:u,vendor:n,keyframes:g}):m("@keyframes missing '}'")})()||(function(){const e=h(),s=/^@media *([^{]+)/.exec(i);if(!s)return;const n=x(l(s)[1]);if(!d())return m("@media missing '{'");const c=y().concat(k());return p()?e({type:o.media,media:n,rules:c}):m("@media missing '}'")})()||(function(){const e=h(),s=/^@custom-media\s+(--\S+)\s+([^{;\s][^{;]*);/.exec(i);if(!s)return;const n=l(s);return e({type:o.customMedia,name:x(n[1]),media:x(n[2])})})()||(function(){const e=h(),s=/^@supports *([^{]+)/.exec(i);if(!s)return;const n=x(l(s)[1]);if(!d())return m("@supports missing '{'");const c=y().concat(k());return p()?e({type:o.supports,supports:n,rules:c}):m("@supports missing '}'")})()||I()||P()||R()||(function(){const e=h(),s=/^@([-\w]+)?document *([^{]+)/.exec(i);if(!s)return;const n=l(s),c=x(n[1]),u=x(n[2]);if(!d())return m("@document missing '{'");const g=y().concat(k());return p()?e({type:o.document,document:u,vendor:c,rules:g}):m("@document missing '}'")})()||(function(){const e=h(),s=/^@page */.exec(i);if(!s)return;l(s);const n=A()||[];if(!d())return m("@page missing '{'");let c=y(),u=V();for(;u;)c.push(u),c=c.concat(y()),u=V();return p()?e({type:o.page,selectors:n,declarations:c}):m("@page missing '}'")})()||(function(){const e=h(),s=/^@host\s*/.exec(i);if(!s)return;if(l(s),!d())return m("@host missing '{'");const n=y().concat(k());return p()?e({type:o.host,rules:n}):m("@host missing '}'")})()||(function(){const e=h(),s=/^@font-face\s*/.exec(i);if(!s)return;if(l(s),!d())return m("@font-face missing '{'");let n=y(),c=V();for(;c;)n.push(c),n=n.concat(y()),c=V();return p()?e({type:o.fontFace,declarations:n}):m("@font-face missing '}'")})()||(function(){const e=h(),s=/^@container *([^{]+)/.exec(i);if(!s)return;const n=x(l(s)[1]);if(!d())return m("@container missing '{'");const c=y().concat(k());return p()?e({type:o.container,container:n,rules:c}):m("@container missing '}'")})()||(function(){const e=h(),s=/^@starting-style\s*/.exec(i);if(!s)return;if(l(s),!d())return m("@starting-style missing '{'");const n=y().concat(k());return p()?e({type:o.startingStyle,rules:n}):m("@starting-style missing '}'")})()||(function(){const e=h(),s=/^@layer *([^{;@]+)/.exec(i);if(!s)return;const n=x(l(s)[1]);if(!d()){const u=/^[;\s]*/.exec(i);return u&&l(u),e({type:o.layer,layer:n})}const c=y().concat(k());return p()?e({type:o.layer,layer:n,rules:c}):m("@layer missing '}'")})()}function q(){const e=h(),s=A();return s?(y(),e({type:o.rule,selectors:s,declarations:S()||[]})):m("selector missing")}return O((function(){const e=k();return{type:o.stylesheet,stylesheet:{source:t==null?void 0:t.source,rules:e,parsingErrors:f}}})())},K=(i,t)=>new H(t||{}).compile(i);export{K as h,J as m};
