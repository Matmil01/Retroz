import{V as p}from"./index-CYxpKrga.min.js";import{l as c}from"./cssesc-BuSGOpl4.js";import{p as i,l as u}from"./pre-process-DMQVYA2C.js";import{s as y}from"./intellisense-YxUDfJ1F.js";import{m,h as f}from"./adobe-css-tools-Dbp5S5wp.min.js";function d(a){try{let l=function(r){return r.filter(s=>s.type==="rule"&&s.selectors?(s.declarations&&(s.declarations=s.declarations.filter(t=>t.type==="declaration"&&t.property&&!t.property.includes("@apply"))),!0):s.type==="atrule"&&s.name==="apply"?!1:(s.type==="atrule"&&s.rules&&(s.rules=l(s.rules)),!0))};const e=m(a,{silent:!0,source:"input.css"});return e.stylesheet&&e.stylesheet.rules&&(e.stylesheet.rules=l(e.stylesheet.rules)),f(e,{compress:!1})}catch(l){console.warn("CSS parsing failed, falling back to regex cleaning:",l);let e=a;return e=e.replace(/@apply\s+[^;{}]*;/g,""),e=e.replace(/@apply\s+[^{}]*(?=\s*})/g,""),e=e.replace(/@apply\s+[^;{}]*$/gm,""),e=e.replace(/^\s*@apply\s*$/gm,""),e}}async function h({entrypoint:a="/main.css",volume:l={},...e}={}){const r={...l};let s=!1;return(e==null?void 0:e.strict)===!0&&(s=!0,delete e.strict),s||Object.keys(r).forEach(t=>{t.endsWith(".css")&&(r[t]=d(r[t]))}),e={entrypoint:a,volume:r,...e,parser:e.strict?y:null},e.volume[e.entrypoint]=(await i(e)).css,p(e.volume[e.entrypoint],{...e,loadModule:async(t,o,n)=>c(t,o,n,e.volume),loadStylesheet:async(t,o)=>u(t,o,e.volume)})}export{h as l};
