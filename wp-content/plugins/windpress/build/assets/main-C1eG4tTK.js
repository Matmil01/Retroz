import{_ as p}from"./preload-helper-DuwVgReH.min.js";import{l as C}from"./logger-BTW-zIW3.js";import{t as j,f as B}from"./tippy.esm-C2cIAwYP.min.js";import{n as q,H as U}from"./highlight-in-textarea-LAZxhTz-.js";import{T as X}from"./tribute.esm-DK9UGgwV.min.js";import{bdeV as m,bdeIframeV as _,bdeIframeCanvas as T,bdeIframe as Y}from"./constant-BZV3uY6b.js";import{d as A}from"./debounce-BB-8SLfJ.min.js";import{s as G}from"./set-CZrLKuYB.min.js";import{c as J,a as K}from"./index-bXyjzgw5.min.js";import{E as g,w as I,P as h}from"./runtime-core.esm-bundler-SLuuURr5.min.js";import"./isObject-K1YoVIH1.min.js";import"./_toKey-BwG29BdO.min.js";import"./index-BAMY2Nnw.min.js";import"./index-rQLcFmgX.min.js";(async()=>{let w=null;(async()=>w=await J({themes:[p(()=>import("./dark-plus-C3mMm8J8.min.js"),[],import.meta.url),p(()=>import("./light-plus-B7mTdjB0.min.js"),[],import.meta.url)],langs:[p(()=>import("./css-DPfMkruS.min.js"),[],import.meta.url)],engine:K(p(()=>import("./wasm-CG6Dc4jp.min.js"),[],import.meta.url))}))();const i=document.createRange().createContextualFragment(`
    <textarea id="windpressbreakdance-plc-input" class="windpressbreakdance-plc-input" rows="2" spellcheck="false"></textarea>
`).querySelector("#windpressbreakdance-plc-input"),b=document.createElement("div");b.classList.add("windpressbreakdance-plc-input-container"),b.appendChild(i);const $=document.createRange().createContextualFragment(`
    <div class="windpressbreakdance-plc-action-container">
        <div class="actions">
        </div>
    </div>
`).querySelector(".windpressbreakdance-plc-action-container"),M=$.querySelector(".actions"),P=document.createRange().createContextualFragment(`
    <span id="windpressbreakdance-plc-class-sort" class="bricks-svg-wrapper windpressbreakdance-plc-class-sort" data-balloon="Automatic Class Sorting" data-balloon-pos="bottom-right">
        <svg  xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round" class="bricks-svg icon icon-tabler icons-tabler-outline icon-tabler-reorder"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M17 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M5 11v-3a3 3 0 0 1 3 -3h8a3 3 0 0 1 3 3v3" /><path d="M16.5 8.5l2.5 2.5l2.5 -2.5" /></svg>    
    </span>
`).querySelector("#windpressbreakdance-plc-class-sort");M.appendChild(P);const k=g(!1),y=g(null);let E=null;q(i);let S=[];wp.hooks.addAction("windpressbreakdance-autocomplete-items-refresh","windpressbreakdance",()=>{S=wp.hooks.applyFilters("windpressbreakdance-autocomplete-items",[],i.value)}),wp.hooks.doAction("windpressbreakdance-autocomplete-items-refresh");const c=new X({menuContainer:document.querySelector("#app"),containerClass:"windpressbreakdance-tribute-container",autocompleteMode:!0,menuItemLimit:50,noMatchTemplate:"",values:async function(e,t){const a=await wp.hooks.applyFilters("windpressbreakdance-autocomplete-items-query",S,e);t(a)},lookup:"value",itemClass:"class-item",menuItemTemplate:function(e){let t="";return e.original.color!==void 0&&(t+=`background-color: ${e.original.color};`),e.original.fontWeight!==void 0&&(t+=`font-weight: ${e.original.fontWeight};`),`
            <span class="class-name" data-tribute-class-name="${e.original.value}">${e.string}</span>
            <span class="class-hint" style="${t}"></span>
        `}});c.setMenuContainer=function(e){this.menuContainer=e};const N=c.events.callbacks;c.events.callbacks=function(){return{...N.call(this),up:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let a=this.tribute.current.filteredItems.length,s=this.tribute.menuSelected;a>s&&s>0?(this.tribute.menuSelected--,this.setActiveLi()):s===0&&(this.tribute.menuSelected=a-1,this.setActiveLi(),this.tribute.menu.scrollTop=this.tribute.menu.scrollHeight),L()}},down:(e,t)=>{if(this.tribute.isActive&&this.tribute.current.filteredItems){e.preventDefault(),e.stopPropagation();let a=this.tribute.current.filteredItems.length-1,s=this.tribute.menuSelected;a>s?(this.tribute.menuSelected++,this.setActiveLi()):a===s&&(this.tribute.menuSelected=0,this.setActiveLi(),this.tribute.menu.scrollTop=0),L()}}}},c.attach(i),m.$store.subscribeAction((e,t)=>{e.type==="ui/activateElement"&&(y.value=e.payload),e.type==="ui/setLeftSidebarState"&&(k.value=e.payload==="elementproperties")}),I([y,k],(e,t)=>{e[0]!==t[0]&&h(()=>{x(),V()}),e[0]&&e[1]&&h(()=>{const a=document.querySelector(".breakdance-element-properties-panel .vscroll-scroll .vscroll-scroll");a&&a.querySelector(".windpressbreakdance-plc-input")===null&&a.insertBefore(b,a.firstChild)})}),E=new U(i,{highlight:[{highlight:new RegExp("(?<=\\s|^)(?:(?!\\s).)+(?=\\s|$)","g"),className:"word"},{highlight:new RegExp("(?<=\\s)\\s","g"),className:"multispace",blank:!0}]});async function x(){var e,t,a,s,n;i.value=((n=(s=(a=(t=(e=m.$store.getters["ui/activeElement"].data)==null?void 0:e.properties)==null?void 0:t.settings)==null?void 0:a.advanced)==null?void 0:s.classes)==null?void 0:n.join(" "))||""}async function F(){var s,n,r,o;if((o=(r=(n=(s=m.$store.getters["ui/activeElement"].data)==null?void 0:s.properties)==null?void 0:n.settings)==null?void 0:r.advanced)!=null&&o.classes)return!0;document.querySelector(".properties-panel-tab.breakdance-tab.breakdance-tab--id-settings").click();let e=document.querySelector("#settings .properties-panel-accordion.conditional-control-display-visible>div");for(;e===null;)e=document.querySelector("#settings .properties-panel-accordion.conditional-control-display-visible>div"),await new Promise(l=>setTimeout(l,100));e.parentElement.classList.contains("expanded")||e.click();let t=document.querySelector('#breakdance-class-input-search input[placeholder=".my-cool-class"]');for(;t===null;)t=document.querySelector('#breakdance-class-input-search input[placeholder=".my-cool-class"]'),await new Promise(l=>setTimeout(l,100));t.focus();const a="windpressbreakdance";return t.value=a,t.dispatchEvent(new Event("input",{bubbles:!0})),await new Promise(l=>setTimeout(l,100)),document.querySelector("#breakdance-class-input-search>button").click(),!0}const R=A(D,50);async function D(){if(!await F()){C("Upstream path not found!",{module:"plain-classes",type:"error"});return}i.focus(),G(m.$store.getters["ui/activeElement"].data,"properties.settings.advanced.classes",i.value.trim().split(" ").filter(e=>e.trim()!=="")||[])}i.addEventListener("input",function(e){R()});function V(){h(()=>{try{E.handleInput()}catch{}q.update(i),c.hideMenu()})}const H=new MutationObserver(function(e){e.forEach(function(t){t.type==="childList"&&t.addedNodes.length>0&&t.addedNodes.forEach(a=>{const s=a.querySelector(".class-name").dataset.tributeClassName;a.addEventListener("mouseenter",n=>{v(s)}),a.addEventListener("mouseleave",n=>{f()}),a.addEventListener("click",n=>{f(),v(s)})})})});let u=null;i.addEventListener("tribute-active-true",function(e){u===null&&(u=document.querySelector(".windpressbreakdance-tribute-container>ul")),h(()=>{u&&H.observe(u,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})})});function v(e){const t=_.$store.getters["ui/activeElement"].id,a=T.querySelector(`[data-node-id="${t}"]`);a.classList.add(e),a.dataset.tributeClassName=e}function f(){O()}function L(){let e=c.menu.querySelector("li.highlight>span.class-name");f(),v(e.dataset.tributeClassName)}function O(){const e=_.$store.getters["ui/activeElement"].id,t=T.querySelector(`[data-node-id="${e}"]`);t.dataset.tributeClassName&&(t.classList.remove(t.dataset.tributeClassName),t.dataset.tributeClassName="")}i.addEventListener("highlights-updated",function(e){z()});let d=j(document.createElement("div"),{plugins:[B],allowHTML:!0,arrow:!1,duration:[500,0],followCursor:!0,trigger:"manual"});function z(){const e=document.querySelector(".hit-container");if(e===null)return;d.reference=e;async function t(n){const r=n.textContent,o=await Y.contentWindow.windpress.module.classnameToCss.generate(r);if(o===null||o.trim()==="")return null;d.setContent(w.codeToHtml(o,{lang:"css",theme:document.querySelector("div#app.theme--light")!==null?"light-plus":"dark-plus"})),d.show()}const a=g(null),s=A(function(n){const r=n.clientX,o=n.clientY,l=document.elementsFromPoint(r,o).find(W=>W.matches('mark[class="word"]'));a.value=l||null},10);e.addEventListener("mousemove",s),e.addEventListener("mouseleave",function(n){s.cancel(),a.value=null}),I(a,(n,r)=>{n&&n!==r?t(n):d.hide()})}C("Module loaded!",{module:"plain-classes"})})();
