import{T as We,b as Ve,d as De}from"./runtime-dom.esm-bundler-DKnqg7YI.min.js";import{l as q}from"./logger-BTW-zIW3.js";import{L as Oe,_ as ze,a as Me,G as je,R as Fe}from"./chevron-right-BVOcWwsE.min.js";import{brx as J,brxGlobalProp as U,brxIframe as Re}from"./constant-B5G-p_vI.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.min.js";import{Z as _,f as Q,$ as Ue,av as B,R as b,J as m,Q as w,aj as T,V as E,O as x,W as Be,E as $,w as W,L as Z,ao as V,a4 as He,K as I,T as D,F as O,U as z,X as H,I as Ke,aw as Ne,P as Xe}from"./runtime-core.esm-bundler-SLuuURr5.min.js";import{d as Ge}from"./vfs-CoPIgrSP.js";import"./index-CYxpKrga.min.js";import"./index-CkDJq9vY.min.js";import"./index-Bx_UX3bn.min.js";import{__tla as Ye}from"./cssesc-BuSGOpl4.js";import{__tla as Je}from"./index-B-0OGoK_.min.js";import{g as Qe}from"./intellisense-YxUDfJ1F.js";import"./redaxios.module-TFmBaLRL.min.js";import{l as Ze}from"./design-system-D7KTzWJK.js";import{u as et}from"./index-Dyb13sZ8.min.js";import{s as tt}from"./set-CZrLKuYB.min.js";import"./floating-ui.core-D4p8F-F6.min.js";import"./virtualRef-C7Pjixvm.js";import"./get-mawGjo0c.min.js";import"./_toKey-BwG29BdO.min.js";import"./isObject-K1YoVIH1.min.js";import"./chunk-HTB5LLOP-Cay67bh1.min.js";import"./index-BAMY2Nnw.min.js";import"./preload-helper-DuwVgReH.min.js";import"./source-map-generator-BtPqY3n1.min.js";import"./index-rQLcFmgX.min.js";import"./index-BkiRcEwW.min.js";import"./pre-process-DMQVYA2C.js";import"./adobe-css-tools-Dbp5S5wp.min.js";Promise.all([(()=>{try{return Ye}catch{}})(),(()=>{try{return Je}catch{}})()]).then(async()=>{const ee={id:"windpressbricks-variable-app-header",class:"header-container"},te={class:"header-content"},oe={class:"header-logo"},re={class:"header-title"},ae={__name:"PanelHeader",setup(a){const t=_("variableApp"),o=_("isOpen");function g(){const c=t.querySelector("#windpressbricks-variable-app-header");let p=$(!1),k=0,v=0;W(p,l=>{l?(document.body.style.userSelect="none",J.style.pointerEvents="none",c.style.cursor="grabbing"):(document.body.style.removeProperty("user-select"),J.style.removeProperty("pointer-events"),c.style.cursor="grab")});const s=l=>{p.value=!0;const r=c.getBoundingClientRect();k=l.clientX-r.left,v=l.clientY-r.top};c.removeEventListener("mousedown",s),c.addEventListener("mousedown",s);const d=l=>{if(!p.value)return;const r=c.getBoundingClientRect(),u=l.clientX,e=l.clientY,n=u-k,i=e-v,f=n<0?0:n>window.innerWidth-r.width?window.innerWidth-r.width:n,h=i<0?0:i>window.innerHeight-r.height?window.innerHeight-r.height:i;t.style.left=`${f}px`,t.style.top=`${h}px`};document.removeEventListener("mousemove",d),document.addEventListener("mousemove",d);const y=l=>{p.value=!1};document.removeEventListener("mouseup",y),document.addEventListener("mouseup",y)}return Q(()=>{g()}),(c,p)=>{const k=Ue("inline-svg"),v=ze,s=B("tooltip");return m(),b("div",ee,[w("div",te,[w("div",oe,[E(k,{src:x(Oe),class:"inline-svg"},null,8,["src"])]),T((m(),b("div",re,[...p[1]||(p[1]=[Be(" WindPress ",-1)])])),[[s,{placement:"top",content:`v${c.windpressbricks._version}`}]]),T((m(),b("button",{class:"header-exit",onClick:p[0]||(p[0]=d=>o.value=!x(o))},[E(v,{class:"iconify"})])),[[s,{placement:"top",content:"Close"}]])])])}}},ne=S(ae,[["__scopeId","data-v-97f7f622"]]),le={class:"header-slot"},se={key:0,class:"expansion-panel__body"},ie={__name:"ExpansionPanel",props:{namespace:{type:String,required:!0},name:{type:String,required:!0}},setup(a,{expose:t}){const o=a,g=$(null),c=et(`windpressbricks-variable-app.ui.expansion-panels.${o.namespace}`,{[`${o.name}`]:!1},void 0,{mergeDefaults:!0});function p(v){c.value[o.name]=v===null?!c.value[o.name]:v}function k(){g.value.scrollIntoView()}return t({togglePanel:p,scrollIntoView:k}),(v,s)=>{const d=Me;return m(),b("div",{ref_key:"sectionRef",ref:g,class:"expansion-panel"},[w("div",{class:He([{},"expansion-panel__header"]),onClick:s[0]||(s[0]=y=>x(c)[a.name]=!x(c)[a.name])},[w("div",le,[Z(v.$slots,"header",{},void 0,!0)]),w("div",null,[E(d,{style:V({transform:x(c)[a.name]?"rotate(-90deg)":"rotate(0deg)"}),class:"iconify"},null,8,["style"])])]),E(We,null,{default:I(()=>[x(c)[a.name]?(m(),b("div",se,[Z(v.$slots,"default",{},void 0,!0)])):D("",!0)]),_:3})],512)}}},M=S(ie,[["__scopeId","data-v-48d9357f"]]),ce={class:"{m:10;pb:15}>div"},ue={class:"variable-section-title font:14 my:10"},pe={class:"variable-section-items flex flex:row gap:8 flex-wrap:wrap"},de=["onClick","onMouseenter"],ve={class:"font:14"},me=1e3,be={__name:"CommonVariableItems",props:{variableItems:{type:Object,required:!0}},setup(a){const t=_("focusedInput"),o=_("recentVariableSelectionTimestamp"),g=_("tempInputValue");function c(v,s){performance.now()-o.value<me||t.value&&(t.value.value=`var(${s})`,t.value.dispatchEvent(new Event("input")),t.value.focus())}function p(v){!t.value||g.value===null||(t.value.value=g.value,t.value.dispatchEvent(new Event("input")),t.value.focus())}function k(v,s){t.value&&(t.value.value=`var(${s})`,t.value.dispatchEvent(new Event("input")),t.value.focus(),g.value=`var(${s})`,o.value=performance.now())}return(v,s)=>{const d=B("tooltip");return m(),b("div",ce,[(m(!0),b(O,null,z(a.variableItems,(y,l)=>(m(),b("div",{key:l,class:"var-item"},[w("div",ue,H(l.replace("_","-")),1),w("div",pe,[y.length>0?(m(!0),b(O,{key:0},z(y,(r,u)=>T((m(),b("button",{key:u,class:"px:12 py:8 r:$(builder-border-radius) fg:$(builder-color) bg:$(builder-bg-2) bg:$(builder-bg-3):hover b:0 flex-grow:1 flex-shrink:1 flex-basis:30% text:center {opacity:.5;font:semibold}>span opacity:100:hover>span",onClick:e=>k(e,r.key),onMouseenter:e=>c(e,r.key),onMouseleave:p},[w("span",ve,H(r.label),1)],40,de)),[[d,{placement:"top",content:`var(${r.key}, ${r.value})`}]])),128)):D("",!0)])]))),128))])}}},K=S(be,[["__scopeId","data-v-ecbe9380"]]);function j(){var t,o;if(U.$_state.activePanel!=="element")return null;const a=(t=U.$_state)==null?void 0:t.activeElement.id;return(o=U.$_getIframeDoc())==null?void 0:o.getElementById(`brxe-${a}`)}function ye({selector:a,callback:t,options:o}){const g=new MutationObserver(t),c=document.querySelector(a);if(!c){q(`Target not found for selector: ${a}`,{module:"variable-picker",type:"error"});return}const p={childList:!0,subtree:!0};g.observe(c,Object.assign(Object.assign({},p),o))}const fe={class:"{m:10;pb:15}>div"},ge={class:"variable-section-title"},ke={key:0,class:"variable-section-items default-color"},he=["onClick","onMouseenter"],we=["onClick","onMouseenter"],_e=1e3,Ee={__name:"ColorVariableItems",props:{variableItems:{type:Object,required:!0}},setup(a){const t=_("focusedInput"),o=_("recentColorPickerTarget"),g=_("recentVariableSelectionTimestamp"),c=_("tempInputValue");function p(l,r){var u;if(!(performance.now()-g.value<_e)){if(!t.value){const e=j();if(!e)return;const n=[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}];for(const{property:i,control:f}of n)(u=o.value)!=null&&u.closest(`[data-control="${f}"]`)&&(e.style[i]=`var(${r})`);return}t.value.value=`var(${r})`,t.value.dispatchEvent(new Event("input")),t.value.focus()}}function k(l){var r;if(!t.value||c.value===null){const u=j();if(!u)return;const e=[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}];for(const{property:n,control:i}of e)(r=o.value)!=null&&r.closest(`[data-control="${i}"]`)&&(u.style[n]="");return}t.value.value=c.value,t.value.dispatchEvent(new Event("input")),t.value.focus()}function v(l,r){if(l.stopPropagation(),l.preventDefault(),!t.value){const u=o.value;y(r),g.value=performance.now(),setTimeout(()=>{const e=j();if(!e)return;const n=[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}];for(const{property:i,control:f}of n)u!=null&&u.closest(`[data-control="${f}"]`)&&(e.style[i]="")},5);return}t.value.value=`var(${r})`,t.value.dispatchEvent(new Event("input")),t.value.focus(),c.value=`var(${r})`,g.value=performance.now()}function s(){document.querySelectorAll(".windpressbricks-variable-app-colorpopup").forEach(l=>{l.remove()})}function d(){if(document.querySelector(".windpressbricks-variable-app-colorpopup"))return;const l=".bricks-control-popup { display: none !important; }",r=document.createElement("style");r.id="windpressbricks-variable-app-bricks-popup",r.appendChild(document.createTextNode(l)),r.classList.add("windpressbricks-variable-app-colorpopup"),document.head.appendChild(r)}async function y(l){var u,e,n,i,f;d(),document.querySelector(".bricks-control-popup .color-palette.grid")||((e=(u=o.value)==null?void 0:u.closest(".bricks-control-preview"))==null||e.click(),await new Promise(h=>setTimeout(h,25)));const r=document.querySelector(".bricks-control-popup .color-palette.grid");r?(i=(n=r.querySelector(`[data-balloon="var(${l})"]`))==null?void 0:n.parentElement)==null||i.click():q("Failed to select color. Color grid not found.",{module:"variable-picker",type:"error"}),(f=document.querySelector("body"))==null||f.click(),await new Promise(h=>setTimeout(h,2)),document.querySelector(".bricks-control-popup")?(setTimeout(()=>{var h;(h=document.querySelector("body"))==null||h.click(),setTimeout(()=>{s()},5)},5),q("Failed to close color picker. Delaying close.",{module:"variable-picker",type:"error"})):s()}return(l,r)=>{const u=B("tooltip");return m(),b("div",fe,[(m(!0),b(O,null,z(a.variableItems,(e,n)=>(m(),b("div",{key:n,class:""},[w("div",ge,H(n),1),e.DEFAULT?(m(),b("div",ke,[T(w("button",{style:V(`--wp-b-v-item-bg: var(--${e.DEFAULT.key.slice(2)});`),class:"",onClick:i=>v(i,e.DEFAULT.key),onMouseenter:i=>p(i,e.DEFAULT.key),onMouseleave:k},null,44,he),[[u,{placement:"top",content:`var(${e.DEFAULT.key}, ${e.DEFAULT.value})`}]])])):D("",!0),e.shades&&Object.keys(e.shades).length>0?(m(),b("div",{key:1,style:V(`--wp-b-v-items-grid: ${Object.keys(e.shades).length}`),class:"variable-section-items shades-colors"},[(m(!0),b(O,null,z(e.shades,(i,f)=>(m(),b("div",{key:f,class:""},[T(w("button",{style:V(`--wp-b-v-item-bg: var(--${i.key.slice(2)})`),onClick:h=>v(h,i.key),onMouseenter:h=>p(h,i.key),onMouseleave:k},null,44,we),[[u,{placement:"top",content:`var(${i.key}, ${i.value})`}]])]))),128))],4)):D("",!0)]))),128))])}}},$e=S(Ee,[["__scopeId","data-v-c22ad97c"]]),Ce={id:"windpressbricks-variable-app-body",class:"var-body"},Ie={__name:"PanelBody",setup(a){const t=$({colors:{},typography:{},sizing:{}}),o=_("focusedInput"),g=_("recentColorPickerTarget");async function c(){const s=Re.contentWindow.document.querySelector('script#windpress\\:vfs[type="text/plain"]'),d=Ge(s.textContent),y=await Qe(await Ze({volume:d})),l={};y.filter(e=>e.key.startsWith("--color")).forEach(e=>{const n=e.key.slice(8),i=n.split("-");let f="";if(i.length>1){const h=i[0],qe=i.slice(1).join("-");f=`${h}.shades.'${qe}'`}else f=`${n}.DEFAULT`;tt(l,f,e)}),t.value.colors=Object.keys(l).sort().reduce((e,n)=>(e[n]=l[n],e),{});const r={font_size:[],line_height:[],letter_spacing:[]};y.filter(e=>e.key.startsWith("--text-")&&!e.key.endsWith("--line-height")).forEach(e=>{const n=e.key.slice(7);r.font_size.push({key:e.key,label:n,value:e.value})}),y.filter(e=>e.key.startsWith("--leading-")||e.key.endsWith("--leading")).forEach(e=>{const n=e.key.startsWith("--leading-")?e.key.slice(10):e.key.slice(2,-9);r.line_height.push({key:e.key,label:n,value:e.value})}),r.line_height.sort((e,n)=>e.label.startsWith("font-size-")&&!n.label.startsWith("font-size-")?1:!e.label.startsWith("font-size-")&&n.label.startsWith("font-size-")?-1:0),y.filter(e=>e.key.startsWith("--tracking-")).forEach(e=>{const n=e.key.slice(11);r.letter_spacing.push({key:e.key,label:n,value:e.value})}),t.value.typography=r;const u={container:[],breakpoint:[]};y.filter(e=>e.key.startsWith("--container-")).forEach(e=>{const n=e.key.slice(12);u.container.push({key:e.key,label:n,value:e.value})}),y.filter(e=>e.key.startsWith("--breakpoint-")).forEach(e=>{const n=e.key.slice(13);u.breakpoint.push({key:e.key,label:n,value:e.value})}),t.value.sizing=u}const p=$(null),k=$(null),v=$(null);return W(o,s=>{var d,y,l,r;if(s){const u=((y=(d=s.closest("[data-controlkey]"))==null?void 0:d.dataset.controlkey)==null?void 0:y.toLocaleLowerCase())??"",e=["typography","font"].some(f=>u.includes(f)),n=["padding","margin","gap","width","height"].some(f=>u.includes(f)),i=(r=(l=s.parentElement)==null?void 0:l.parentElement)==null?void 0:r.classList.contains("color-input");k.value.togglePanel(!1),v.value.togglePanel(!1),p.value.togglePanel(!1),i?(p.value.togglePanel(!0),p.value.scrollIntoView()):e?(k.value.togglePanel(!0),k.value.scrollIntoView()):n&&(v.value.togglePanel(!0),v.value.scrollIntoView())}}),W(g,s=>{s&&(p.value.togglePanel(!0),p.value.scrollIntoView())}),Q(()=>{c()}),new BroadcastChannel("windpress").addEventListener("message",async s=>{const d=s.data;d.source==="windpress/intellisense"&&d.task==="windpress.code-editor.saved.done"&&setTimeout(()=>{c()},1e3)}),(s,d)=>(m(),b("div",Ce,[E(M,{ref_key:"sectionColor",ref:p,namespace:"variable",name:"color"},{header:I(()=>[...d[0]||(d[0]=[w("span",{class:"var-body-title"},"Color",-1)])]),default:I(()=>[E($e,{"variable-items":t.value.colors},null,8,["variable-items"])]),_:1},512),E(M,{ref_key:"sectionTypography",ref:k,namespace:"variable",name:"typography"},{header:I(()=>[...d[1]||(d[1]=[w("span",{class:"var-body-title"},"Typography",-1)])]),default:I(()=>[E(K,{"variable-items":t.value.typography},null,8,["variable-items"])]),_:1},512),E(M,{ref_key:"sectionSpacing",ref:v,namespace:"variable",name:"spacing",class:""},{header:I(()=>[...d[2]||(d[2]=[w("span",{class:"var-body-title"},"Sizing",-1)])]),default:I(()=>[E(K,{"variable-items":t.value.sizing},null,8,["variable-items"])]),_:1},512)]))}},xe=S(Ie,[["__scopeId","data-v-cb1fc473"]]),Pe={id:"windpressbricks-variable-app-container",class:"wp-b-var-container"},Se={__name:"App",setup(a){const t=_("isOpen");return(o,g)=>T((m(),b("div",Pe,[E(ne),(m(),Ke(Ne,null,{default:I(()=>[E(xe)]),_:1}))],512)),[[Ve,x(t)]])}},Te=S(Se,[["__scopeId","data-v-8a9882a1"]]),L=document.createElement("windpressbricks-variable-app");L.id="windpressbricks-variable-app",document.body.appendChild(L);const P=$(!1),A=$(null),N=$(null),F=$(null),Le=$(0),C=De(Te);C.config.globalProperties.windpressbricks=window.windpressbricks,C.provide("variableApp",L),C.provide("isOpen",P),C.provide("focusedInput",A),C.provide("tempInputValue",N),C.provide("recentColorPickerTarget",F),C.provide("recentVariableSelectionTimestamp",Le),C.use(je,{container:"#windpressbricks-variable-app"}),C.component("InlineSvg",Fe),C.mount("#windpressbricks-variable-app");function X(a){var t;!a.shiftKey||!a.target||((t=document==null?void 0:document.getSelection())==null||t.removeAllRanges(),a.preventDefault(),a.stopPropagation(),A.value=a.target,N.value=a.target.value,P.value=!0)}function G(a){A.value=a.target}const Ae=['div[data-control="number"]',{selector:'div[data-control="text"]',hasChild:["#_flexBasis","#_overflow","#_gridTemplateColumns","#_gridTemplateRows","#_gridAutoColumns","#_gridAutoRows","#_objectPosition",'[id^="raw-"]']}];function Y(){setTimeout(()=>{Ae.forEach(a=>{(typeof a=="string"?[...document.querySelectorAll(a)]:[...document.querySelectorAll(a.selector)].filter(t=>a.hasChild.some(o=>t.querySelector(o)))).forEach(t=>{const o=t.querySelector("input[type='text']");(o==null?void 0:o.getAttribute("windpressbricks-variable-app"))!=="listened"&&(o==null||o.removeEventListener("click",X),o==null||o.addEventListener("click",X),o==null||o.removeEventListener("focus",G),o==null||o.addEventListener("focus",G),o==null||o.setAttribute("windpressbricks-variable-app","listened"),o==null||o.parentNode.setAttribute("data-balloon","Shift + click to open the Variable Picker"),o==null||o.parentNode.setAttribute("data-balloon-pos","bottom-right"))})}),[...document.querySelectorAll(".bricks-control-preview")].filter(a=>{var t,o;return((o=(t=a.closest(".control-inner"))==null?void 0:t.querySelector("label"))==null?void 0:o.getAttribute("for"))==="color"}).forEach(a=>{a.addEventListener("contextmenu",t=>{var o;!t.shiftKey||!t.target||(t.preventDefault(),t.stopPropagation(),(o=document==null?void 0:document.getSelection())==null||o.removeAllRanges(),A.value=null,P.value=!0,F.value=null,Xe(()=>{F.value=t.target}))})})},100)}let R=!1;ye({selector:"#bricks-panel-inner",options:{subtree:!0,childList:!0},callback(){R||(R=!0,Y(),setTimeout(()=>{R=!1},100))}}),Y(),document.addEventListener("keydown",a=>{a.key==="Escape"&&P.value&&(P.value=!1)}),W(P,a=>{L.style.zIndex=a?"calc(Infinity)":"-1"}),q("Module loaded!",{module:"variable-picker"})});
