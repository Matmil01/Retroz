import{l as L}from"../../../../design-system-D7KTzWJK.js";import{d as $}from"../../../../vfs-CoPIgrSP.js";import{c as q,b as B,a as E}from"../../../../intellisense-YxUDfJ1F.js";import{F}from"../../../../fuse-Dw8P0qyA.min.js";import{p as H,w as j}from"../../../../index-L8AGAgXa.min.js";import{s as h}from"../../../../set-CZrLKuYB.min.js";import"../../../../index-CYxpKrga.min.js";import"../../../../chunk-HTB5LLOP-Cay67bh1.min.js";import"../../../../index-Bx_UX3bn.min.js";import"../../../../index-BAMY2Nnw.min.js";import"../../../../cssesc-BuSGOpl4.js";import"../../../../preload-helper-DuwVgReH.min.js";import"../../../../index-CkDJq9vY.min.js";import"../../../../source-map-generator-BtPqY3n1.min.js";import"../../../../index-rQLcFmgX.min.js";import"../../../../pre-process-DMQVYA2C.js";import"../../../../adobe-css-tools-Dbp5S5wp.min.js";import"../../../../index-BkiRcEwW.min.js";import"../../../../_toKey-BwG29BdO.min.js";import"../../../../isObject-K1YoVIH1.min.js";async function I(e,t){let o=t.split(/\s+/).filter(l=>l!==""&&l!=="|"),s=await q(e,o);return Array.isArray(s)?s.join(" "):s}async function W(e,t){let o=t.split(/\s+/).filter(s=>s!==""&&s!=="|");return(await B(e,o)).join(" ")}let p=null;function x(e){return btoa(JSON.stringify(Object.keys(e).sort().map(t=>`${t}:${e[t].length}`)))}function D(){p=null}function C(e){var t;return((t=e==null?void 0:e.find(o=>o.property.includes("color")))==null?void 0:t.value)||null}function T(e){const t=new Set,o=s=>s.replace(/\\([0-9a-fA-F]{1,6}) ?/g,(l,c)=>String.fromCodePoint(parseInt(c,16))).replace(/\\([^\s])/g,"$1");for(const s of Object.keys(e))if(s.endsWith(".css")){const l=H(e[s]);j(l,{visit:"Selector",enter(c){j(c,{visit:"ClassSelector",enter(m){t.add(o(m.name))}})}})}return Array.from(t).map(s=>({kind:"user",selector:s}))}function P(e,t,o,s=!1){const l=x(e),c=Date.now();(s||!p||p.volumeHash!==l)&&(p={classLists:[...E(t),...T(e)],volumeHash:l,timestamp:c,queryCache:new Map});const{classLists:m,queryCache:u}=p;if(u.has(o))return u.get(o);if(o===""){const n=m.map(r=>({value:r.selector,color:C(r.declarations)}));return u.set(o,n),n}let b=o.split(":"),A=b.slice(0,-1).join(":"),i=b.pop()||"",v="";i.startsWith("!")&&(i=i.slice(1),v="!");let a=!1;if(i.includes("/")){let[n,r]=i.split("/");r===""?(i=n,a=r):isNaN(Number(r))||Number(r)<0||Number(r)>100?i=[n,r].join("/"):(i=n,a=parseInt(r.toString()))}let w=m.filter(n=>n.selector.includes(i));if(a!==!1){let n=[];const r=a===""?5:1,M=a===""||Number(a)>9?0:Math.floor((Number(a)*10+1)/10)*10,J=a===""||Number(a)>9?100:Math.ceil((Number(a)*10+1)/10)*10;w.forEach(S=>{for(let y=M;y<=J;y+=r)n.push({...S,selector:S.selector+"/"+y})}),w=n}const N=new F(w,{keys:["selector"],threshold:.4}).search(i).map(n=>{const r=n.item;return{value:[A,(v?"!":"")+r.selector].filter(Boolean).join(":"),color:C(r.declarations)}});return u.set(o,N),N}const k=new BroadcastChannel("windpress"),g=document.querySelector('script#windpress\\:vfs[type="text/plain"]');let d,f;async function O(){const e=$((g==null?void 0:g.textContent)||"e30=");JSON.stringify(f)!==JSON.stringify(e)&&D(),f=e,d=await L({volume:f}),k.postMessage({source:"windpress/intellisense",target:"any",task:"windpress.code-editor.saved.done"})}O(),k.addEventListener("message",async e=>{const t=e.data;t.source==="windpress/dashboard"&&t.target==="windpress/intellisense"&&t.task==="windpress.code-editor.saved"&&O()}),h(window,"windpress.module.autocomplete.query",e=>P(f,d,e)),h(window,"windpress.module.classnameToCss.generate",async e=>I(d,e)),h(window,"windpress.module.classSorter.sort",async e=>W(d,e));
