import"./source-map-generator-CTyyJ0I2.min.js";import"./dist-C_ABUlOQ.min.js";import{O as Te,S as y,X as _,b as Pe,k as E,nj as x,nx as $,re as Le,ri as U,rr as q,s as W,tC as Q,tG as V,tQ as T,tS as D,tT as B,tX as S,tg as m,tr as Ae,tu as J,tw as qe,u as We,x as O,y as w}from"./runtime-core.esm-bundler-Ca9eACeg.min.js";import{n as Ve,r as De,s as Oe}from"./vue.runtime.esm-bundler-B7l4RX9R.min.js";import"./dist-BRFYlgNW.min.js";import"./log-BwehX2sj.js";import"./chunk-HTB5LLOP-BErhSb2z.min.js";import{f as ze}from"./core-CuG4XPOF.min.js";import"./floating-ui.core-BwRAMOlv.min.js";import"./api-j1hi8yn9.js";import"./index.browser-L__kdN7m.min.js";import"./isObject-BwTgHO42.min.js";import"./_toKey-BLmsLsy5.min.js";import{t as Me}from"./set-Cqd4I9bq.min.js";import"./get-BfBXFw95.min.js";import"./virtualRef-CYpkks3b.js";import"./preload-helper-hRiy8xQv.min.js";import"./base64-DC2Lnao2.min.js";import"./lib-Bhom85nO.min.js";import"./dist-Bc3DqNCA.min.js";import"./path-browserify-BdtUGfkV.min.js";import"./pre-process-RWgsscQ9.js";import{__tla as je}from"./cssesc-Brw5KDvH.js";import{__tla as Fe}from"./lightningcss-wasm-6j4Pv-Sn.min.js";import"./build-B3SDJAft.js";import{t as Re}from"./vfs-Cd6bW2_1.js";import{c as Ue,i as Be}from"./intellisense-BXfxfrXI.js";import"./adobe-css-tools-Cq8Zs2rG.min.js";import"./dlv.umd-9now9_xM.min.js";import{__tla as Xe}from"./tailwindcss-DJIKWk4_.js";import{t as z}from"./logger-B3j_KY2M.js";import{t as P}from"./_plugin-vue_export-helper-89dl49sx.min.js";import{a as He,i as Ne,n as Ke,r as Ye,t as Ge}from"./chevron-right-DnvxkMx1.min.js";import{n as X,r as Qe,t as Z}from"./constant-DAySPcnT.js";Promise.all([(()=>{try{return je}catch{}})(),(()=>{try{return Fe}catch{}})(),(()=>{try{return Xe}catch{}})()]).then(async()=>{var ee={id:"windpressbricks-variable-app-header",class:"header-container"},te={class:"header-content"},re={class:"header-logo"},ae={class:"header-title"},le=P({__name:"PanelHeader",setup(a){let t=_("variableApp"),r=_("isOpen");function g(){let c=t.querySelector("#windpressbricks-variable-app-header"),d=$(!1),k=0,v=0;V(d,n=>{n?(document.body.style.userSelect="none",Z.style.pointerEvents="none",c.style.cursor="grabbing"):(document.body.style.removeProperty("user-select"),Z.style.removeProperty("pointer-events"),c.style.cursor="grab")});let i=n=>{d.value=!0;let l=c.getBoundingClientRect();k=n.clientX-l.left,v=n.clientY-l.top};c.removeEventListener("mousedown",i),c.addEventListener("mousedown",i);let u=n=>{if(!d.value)return;let l=c.getBoundingClientRect(),p=n.clientX,e=n.clientY,o=p-k,s=e-v,f=o<0?0:o>window.innerWidth-l.width?window.innerWidth-l.width:o,h=s<0?0:s>window.innerHeight-l.height?window.innerHeight-l.height:s;t.style.left=`${f}px`,t.style.top=`${h}px`};document.removeEventListener("mousemove",u),document.addEventListener("mousemove",u);let b=n=>{d.value=!1};document.removeEventListener("mouseup",b),document.addEventListener("mouseup",b)}return J(()=>{g()}),(c,d)=>{let k=qe("inline-svg"),v=Ye,i=B("tooltip");return m(),y("div",ee,[w("div",te,[w("div",re,[E(k,{src:x(Ke),class:"inline-svg"},null,8,["src"])]),T((m(),y("div",ae,[...d[1]||(d[1]=[Te(" WindPress ",-1)])])),[[i,{placement:"top",content:`v${c.windpressbricks._version}`}]]),T((m(),y("button",{class:"header-exit",onClick:d[0]||(d[0]=u=>r.value=!x(r))},[E(v,{class:"iconify"})])),[[i,{placement:"top",content:"Close"}]])])])}}},[["__scopeId","data-v-97f7f622"]]),oe={class:"header-slot"},ne={key:0,class:"expansion-panel__body"},ie={__name:"ExpansionPanel",props:{namespace:{type:String,required:!0},name:{type:String,required:!0}},setup(a,{expose:t}){let r=a,g=$(null),c=ze(`windpressbricks-variable-app.ui.expansion-panels.${r.namespace}`,{[`${r.name}`]:!1},void 0,{mergeDefaults:!0});function d(v){c.value[r.name]=v===null?!c.value[r.name]:v}function k(){g.value.scrollIntoView()}return t({togglePanel:d,scrollIntoView:k}),(v,i)=>{let u=Ge;return m(),y("div",{ref_key:"sectionRef",ref:g,class:"expansion-panel"},[w("div",{class:Le([{},"expansion-panel__header"]),onClick:i[0]||(i[0]=b=>x(c)[a.name]=!x(c)[a.name])},[w("div",oe,[Q(v.$slots,"header",{},void 0,!0)]),w("div",null,[E(u,{style:q({transform:x(c)[a.name]?"rotate(-90deg)":"rotate(0deg)"}),class:"iconify"},null,8,["style"])])]),E(Ve,null,{default:S(()=>[x(c)[a.name]?(m(),y("div",ne,[Q(v.$slots,"default",{},void 0,!0)])):O("",!0)]),_:3})],512)}}},M=P(ie,[["__scopeId","data-v-48d9357f"]]),se={class:"{m:10;pb:15}>div"},ce={class:"variable-section-title font:14 my:10"},ue={class:"variable-section-items flex flex:row gap:8 flex-wrap:wrap"},pe=["onClick","onMouseenter"],de={class:"font:14"},ve={__name:"CommonVariableItems",props:{variableItems:{type:Object,required:!0}},setup(a){let t=_("focusedInput"),r=_("recentVariableSelectionTimestamp"),g=_("tempInputValue");function c(v,i){performance.now()-r.value<1e3||t.value&&(t.value.value=`var(${i})`,t.value.dispatchEvent(new Event("input")),t.value.focus())}function d(v){!t.value||g.value===null||(t.value.value=g.value,t.value.dispatchEvent(new Event("input")),t.value.focus())}function k(v,i){t.value&&(t.value.value=`var(${i})`,t.value.dispatchEvent(new Event("input")),t.value.focus(),g.value=`var(${i})`,r.value=performance.now())}return(v,i)=>{let u=B("tooltip");return m(),y("div",se,[(m(!0),y(W,null,D(a.variableItems,(b,n)=>(m(),y("div",{key:n,class:"var-item"},[w("div",ce,U(n.replace("_","-")),1),w("div",ue,[b.length>0?(m(!0),y(W,{key:0},D(b,(l,p)=>T((m(),y("button",{key:p,class:"px:12 py:8 r:$(builder-border-radius) fg:$(builder-color) bg:$(builder-bg-2) bg:$(builder-bg-3):hover b:0 flex-grow:1 flex-shrink:1 flex-basis:30% text:center {opacity:.5;font:semibold}>span opacity:100:hover>span",onClick:e=>k(e,l.key),onMouseenter:e=>c(e,l.key),onMouseleave:d},[w("span",de,U(l.label),1)],40,pe)),[[u,{placement:"top",content:`var(${l.key}, ${l.value})`}]])),128)):O("",!0)])]))),128))])}}},H=P(ve,[["__scopeId","data-v-ecbe9380"]]);function j(){var t,r;if(X.$_state.activePanel!=="element")return null;let a=(t=X.$_state)==null?void 0:t.activeElement.id;return(r=X.$_getIframeDoc())==null?void 0:r.getElementById(`brxe-${a}`)}function me({selector:a,callback:t,options:r}){let g=new MutationObserver(t),c=document.querySelector(a);if(!c){z(`Target not found for selector: ${a}`,{module:"variable-picker",type:"error"});return}g.observe(c,Object.assign(Object.assign({},{childList:!0,subtree:!0}),r))}var ye={class:"{m:10;pb:15}>div"},be={class:"variable-section-title"},fe={key:0,class:"variable-section-items default-color"},ge=["onClick","onMouseenter"],ke=["onClick","onMouseenter"],he={__name:"ColorVariableItems",props:{variableItems:{type:Object,required:!0}},setup(a){let t=_("focusedInput"),r=_("recentColorPickerTarget"),g=_("recentVariableSelectionTimestamp"),c=_("tempInputValue");function d(n,l){var p;if(!(performance.now()-g.value<1e3)){if(!t.value){let e=j();if(!e)return;let o=[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}];for(let{property:s,control:f}of o)(p=r.value)!=null&&p.closest(`[data-control="${f}"]`)&&(e.style[s]=`var(${l})`);return}t.value.value=`var(${l})`,t.value.dispatchEvent(new Event("input")),t.value.focus()}}function k(n){var l;if(!t.value||c.value===null){let p=j();if(!p)return;let e=[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}];for(let{property:o,control:s}of e)(l=r.value)!=null&&l.closest(`[data-control="${s}"]`)&&(p.style[o]="");return}t.value.value=c.value,t.value.dispatchEvent(new Event("input")),t.value.focus()}function v(n,l){if(n.stopPropagation(),n.preventDefault(),!t.value){let p=r.value;b(l),g.value=performance.now(),setTimeout(()=>{let e=j();if(!e)return;let o=[{property:"color",control:"typography"},{property:"backgroundColor",control:"background"},{property:"borderColor",control:"border"}];for(let{property:s,control:f}of o)p!=null&&p.closest(`[data-control="${f}"]`)&&(e.style[s]="")},5);return}t.value.value=`var(${l})`,t.value.dispatchEvent(new Event("input")),t.value.focus(),c.value=`var(${l})`,g.value=performance.now()}function i(){document.querySelectorAll(".windpressbricks-variable-app-colorpopup").forEach(n=>{n.remove()})}function u(){if(document.querySelector(".windpressbricks-variable-app-colorpopup"))return;let n=document.createElement("style");n.id="windpressbricks-variable-app-bricks-popup",n.appendChild(document.createTextNode(".bricks-control-popup { display: none !important; }")),n.classList.add("windpressbricks-variable-app-colorpopup"),document.head.appendChild(n)}async function b(n){var p,e,o,s,f;u(),document.querySelector(".bricks-control-popup .color-palette.grid")||((e=(p=r.value)==null?void 0:p.closest(".bricks-control-preview"))==null||e.click(),await new Promise(h=>setTimeout(h,25)));let l=document.querySelector(".bricks-control-popup .color-palette.grid");l?(s=(o=l.querySelector(`[data-balloon="var(${n})"]`))==null?void 0:o.parentElement)==null||s.click():z("Failed to select color. Color grid not found.",{module:"variable-picker",type:"error"}),(f=document.querySelector("body"))==null||f.click(),await new Promise(h=>setTimeout(h,2)),document.querySelector(".bricks-control-popup")?(setTimeout(()=>{var h;(h=document.querySelector("body"))==null||h.click(),setTimeout(()=>{i()},5)},5),z("Failed to close color picker. Delaying close.",{module:"variable-picker",type:"error"})):i()}return(n,l)=>{let p=B("tooltip");return m(),y("div",ye,[(m(!0),y(W,null,D(a.variableItems,(e,o)=>(m(),y("div",{key:o,class:""},[w("div",be,U(o),1),e.DEFAULT?(m(),y("div",fe,[T(w("button",{style:q(`--wp-b-v-item-bg: var(--${e.DEFAULT.key.slice(2)});`),class:"",onClick:s=>v(s,e.DEFAULT.key),onMouseenter:s=>d(s,e.DEFAULT.key),onMouseleave:k},null,44,ge),[[p,{placement:"top",content:`var(${e.DEFAULT.key}, ${e.DEFAULT.value})`}]])])):O("",!0),e.shades&&Object.keys(e.shades).length>0?(m(),y("div",{key:1,style:q(`--wp-b-v-items-grid: ${Object.keys(e.shades).length}`),class:"variable-section-items shades-colors"},[(m(!0),y(W,null,D(e.shades,(s,f)=>(m(),y("div",{key:f,class:""},[T(w("button",{style:q(`--wp-b-v-item-bg: var(--${s.key.slice(2)})`),onClick:h=>v(h,s.key),onMouseenter:h=>d(h,s.key),onMouseleave:k},null,44,ke),[[p,{placement:"top",content:`var(${s.key}, ${s.value})`}]])]))),128))],4)):O("",!0)]))),128))])}}},we=P(he,[["__scopeId","data-v-c22ad97c"]]),_e={id:"windpressbricks-variable-app-body",class:"var-body"},Ee=P({__name:"PanelBody",setup(a){let t=$({colors:{},typography:{},sizing:{}}),r=_("focusedInput"),g=_("recentColorPickerTarget");async function c(){let i=Qe.contentWindow.document.querySelector('script#windpress\\:vfs[type="text/plain"]'),u=Re(i.textContent),b=await Be(await Ue({volume:u})),n={};b.filter(e=>e.key.startsWith("--color")).forEach(e=>{let o=e.key.slice(8),s=o.split("-"),f="";if(s.length>1){let h=s[0],Ie=s.slice(1).join("-");f=`${h}.shades.'${Ie}'`}else f=`${o}.DEFAULT`;Me(n,f,e)}),t.value.colors=Object.keys(n).sort().reduce((e,o)=>(e[o]=n[o],e),{});let l={font_size:[],line_height:[],letter_spacing:[]};b.filter(e=>e.key.startsWith("--text-")&&!e.key.endsWith("--line-height")).forEach(e=>{let o=e.key.slice(7);l.font_size.push({key:e.key,label:o,value:e.value})}),b.filter(e=>e.key.startsWith("--leading-")||e.key.endsWith("--leading")).forEach(e=>{let o=e.key.startsWith("--leading-")?e.key.slice(10):e.key.slice(2,-9);l.line_height.push({key:e.key,label:o,value:e.value})}),l.line_height.sort((e,o)=>e.label.startsWith("font-size-")&&!o.label.startsWith("font-size-")?1:!e.label.startsWith("font-size-")&&o.label.startsWith("font-size-")?-1:0),b.filter(e=>e.key.startsWith("--tracking-")).forEach(e=>{let o=e.key.slice(11);l.letter_spacing.push({key:e.key,label:o,value:e.value})}),t.value.typography=l;let p={container:[],breakpoint:[]};b.filter(e=>e.key.startsWith("--container-")).forEach(e=>{let o=e.key.slice(12);p.container.push({key:e.key,label:o,value:e.value})}),b.filter(e=>e.key.startsWith("--breakpoint-")).forEach(e=>{let o=e.key.slice(13);p.breakpoint.push({key:e.key,label:o,value:e.value})}),t.value.sizing=p}let d=$(null),k=$(null),v=$(null);return V(r,i=>{var u,b,n,l;if(i){let p=((b=(u=i.closest("[data-controlkey]"))==null?void 0:u.dataset.controlkey)==null?void 0:b.toLocaleLowerCase())??"",e=["typography","font"].some(f=>p.includes(f)),o=["padding","margin","gap","width","height"].some(f=>p.includes(f)),s=(l=(n=i.parentElement)==null?void 0:n.parentElement)==null?void 0:l.classList.contains("color-input");k.value.togglePanel(!1),v.value.togglePanel(!1),d.value.togglePanel(!1),s?(d.value.togglePanel(!0),d.value.scrollIntoView()):e?(k.value.togglePanel(!0),k.value.scrollIntoView()):o&&(v.value.togglePanel(!0),v.value.scrollIntoView())}}),V(g,i=>{i&&(d.value.togglePanel(!0),d.value.scrollIntoView())}),J(()=>{c()}),new BroadcastChannel("windpress").addEventListener("message",async i=>{let u=i.data;u.source==="windpress/intellisense"&&u.task==="windpress.code-editor.saved.done"&&setTimeout(()=>{c()},1e3)}),(i,u)=>(m(),y("div",_e,[E(M,{ref_key:"sectionColor",ref:d,namespace:"variable",name:"color"},{header:S(()=>[...u[0]||(u[0]=[w("span",{class:"var-body-title"},"Color",-1)])]),default:S(()=>[E(we,{"variable-items":t.value.colors},null,8,["variable-items"])]),_:1},512),E(M,{ref_key:"sectionTypography",ref:k,namespace:"variable",name:"typography"},{header:S(()=>[...u[1]||(u[1]=[w("span",{class:"var-body-title"},"Typography",-1)])]),default:S(()=>[E(H,{"variable-items":t.value.typography},null,8,["variable-items"])]),_:1},512),E(M,{ref_key:"sectionSpacing",ref:v,namespace:"variable",name:"spacing",class:""},{header:S(()=>[...u[2]||(u[2]=[w("span",{class:"var-body-title"},"Sizing",-1)])]),default:S(()=>[E(H,{"variable-items":t.value.sizing},null,8,["variable-items"])]),_:1},512)]))}},[["__scopeId","data-v-cb1fc473"]]),$e={id:"windpressbricks-variable-app-container",class:"wp-b-var-container"},Ce=P({__name:"App",setup(a){let t=_("isOpen");return(r,g)=>T((m(),y("div",$e,[E(le),(m(),Pe(We,null,{default:S(()=>[E(Ee)]),_:1}))],512)),[[Oe,x(t)]])}},[["__scopeId","data-v-8a9882a1"]]),L=document.createElement("windpressbricks-variable-app");L.id="windpressbricks-variable-app",document.body.appendChild(L);var I=$(!1),A=$(null),N=$(null),F=$(null),Se=$(0),C=De(Ce);C.config.globalProperties.windpressbricks=window.windpressbricks,C.provide("variableApp",L),C.provide("isOpen",I),C.provide("focusedInput",A),C.provide("tempInputValue",N),C.provide("recentColorPickerTarget",F),C.provide("recentVariableSelectionTimestamp",Se),C.use(Ne,{container:"#windpressbricks-variable-app"}),C.component("InlineSvg",He),C.mount("#windpressbricks-variable-app");function K(a){var t;!a.shiftKey||!a.target||((t=document==null?void 0:document.getSelection())==null||t.removeAllRanges(),a.preventDefault(),a.stopPropagation(),A.value=a.target,N.value=a.target.value,I.value=!0)}function Y(a){A.value=a.target}var xe=['div[data-control="number"]',{selector:'div[data-control="text"]',hasChild:["#_flexBasis","#_overflow","#_gridTemplateColumns","#_gridTemplateRows","#_gridAutoColumns","#_gridAutoRows","#_objectPosition",'[id^="raw-"]']}];function G(){setTimeout(()=>{xe.forEach(a=>{(typeof a=="string"?[...document.querySelectorAll(a)]:[...document.querySelectorAll(a.selector)].filter(t=>a.hasChild.some(r=>t.querySelector(r)))).forEach(t=>{let r=t.querySelector("input[type='text']");(r==null?void 0:r.getAttribute("windpressbricks-variable-app"))!=="listened"&&(r==null||r.removeEventListener("click",K),r==null||r.addEventListener("click",K),r==null||r.removeEventListener("focus",Y),r==null||r.addEventListener("focus",Y),r==null||r.setAttribute("windpressbricks-variable-app","listened"),r==null||r.parentNode.setAttribute("data-balloon","Shift + click to open the Variable Picker"),r==null||r.parentNode.setAttribute("data-balloon-pos","bottom-right"))})}),[...document.querySelectorAll(".bricks-control-preview")].filter(a=>{var t,r;return((r=(t=a.closest(".control-inner"))==null?void 0:t.querySelector("label"))==null?void 0:r.getAttribute("for"))==="color"}).forEach(a=>{a.addEventListener("contextmenu",t=>{var r;!t.shiftKey||!t.target||(t.preventDefault(),t.stopPropagation(),(r=document==null?void 0:document.getSelection())==null||r.removeAllRanges(),A.value=null,I.value=!0,F.value=null,Ae(()=>{F.value=t.target}))})})},100)}var R=!1;me({selector:"#bricks-panel-inner",options:{subtree:!0,childList:!0},callback(){R||(R=!0,G(),setTimeout(()=>{R=!1},100))}}),G(),document.addEventListener("keydown",a=>{a.key==="Escape"&&I.value&&(I.value=!1)}),V(I,a=>{L.style.zIndex=a?"calc(Infinity)":"-1"}),z("Module loaded!",{module:"variable-picker"})});
